{% extends "base.html" %}

{% block page_title %}Team Management - MEGA DASHBOARD{% endblock %}
{% block title %}Team Management{% endblock %}

{% block content %}
<div class="management-layout">
    <!-- Header Actions -->
    <div class="management-header">
        <div class="header-info">
            <p class="header-subtitle">Manage your interview teams and expert assignments</p>
        </div>
        <form action="{{ url_for('teams.add_team') }}" method="POST" class="add-team-form">
            <input type="text" name="team_name" placeholder="Enter new team name..." required class="input-team">
            <button type="submit" class="btn btn-primary">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                    <line x1="12" y1="5" x2="12" y2="19" />
                    <line x1="5" y1="12" x2="19" y2="12" />
                </svg>
                Add Team
            </button>
        </form>
    </div>

    <!-- Teams Grid -->
    <div class="teams-grid">
        {% for team in teams %}
        <div class="team-card card">
            <div class="team-card-header">
                <div class="team-card-title">
                    <div class="team-icon-wrapper">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <circle cx="9" cy="7" r="3" />
                            <circle cx="15" cy="7" r="3" />
                            <path d="M3 18c0-3 3-5 6-5M15 13c3 0 6 2 6 5" />
                        </svg>
                    </div>
                    <div>
                        <h3>{{ team.name }}</h3>
                        <span class="team-member-count">{{ team.members|length }} members</span>
                    </div>
                </div>
                <form action="{{ url_for('teams.delete_team', team_name=team.name) }}" method="POST"
                    onsubmit="return confirm('Are you sure you want to delete this team?');">
                    <button type="submit" class="btn-icon danger" title="Delete team">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <polyline points="3,6 5,6 21,6" />
                            <path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2" />
                            <line x1="10" y1="11" x2="10" y2="17" />
                            <line x1="14" y1="11" x2="14" y2="17" />
                        </svg>
                    </button>
                </form>
            </div>

            <div class="team-members-list">
                {% if team.members %}
                {% for member in team.members %}
                <div class="member-item">
                    <div class="member-info">
                        <div class="member-avatar">{{ member[0]|upper }}</div>
                        <div class="member-details">
                            <span class="member-name">{{ member.split('@')[0] }}</span>
                            <span class="member-email">{{ member }}</span>
                        </div>
                    </div>
                    <form action="{{ url_for('teams.remove_member') }}" method="POST" class="remove-member-form">
                        <input type="hidden" name="team_name" value="{{ team.name }}">
                        <input type="hidden" name="email" value="{{ member }}">
                        <button type="submit" class="btn-icon-sm" title="Remove member">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <line x1="18" y1="6" x2="6" y2="18" />
                                <line x1="6" y1="6" x2="18" y2="18" />
                            </svg>
                        </button>
                    </form>
                </div>
                {% endfor %}
                {% else %}
                <div class="empty-members">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <circle cx="12" cy="8" r="4" />
                        <path d="M4 20c0-4 4-6 8-6s8 2 8 6" />
                    </svg>
                    <p>No members yet</p>
                </div>
                {% endif %}
            </div>

            <form action="{{ url_for('teams.add_member') }}" method="POST" class="add-member-form">
                <input type="hidden" name="team_name" value="{{ team.name }}">
                <input type="email" name="email" placeholder="Add expert email..." required class="input-email">
                <button type="submit" class="btn btn-ghost btn-sm">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
                        <line x1="12" y1="5" x2="12" y2="19" />
                        <line x1="5" y1="12" x2="19" y2="12" />
                    </svg>
                    Add
                </button>
            </form>
        </div>
        {% else %}
        <div class="empty-state-card card">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <circle cx="9" cy="7" r="3" />
                <circle cx="15" cy="7" r="3" />
                <path d="M3 18c0-3 3-5 6-5M15 13c3 0 6 2 6 5" />
            </svg>
            <h3>No teams yet</h3>
            <p>Create your first team to get started with organizing your interview experts.</p>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}